## Objectif
Rendre les résultats de recherche « Pro Search » et « Deep Research » plus visuels en affichant, pour chaque source, une image cliquable (Open Graph) qui ouvre la page dans un nouvel onglet.

## Changements principaux
- UI (SearchResultsList):
  - Remplacement de la liste de badges par une grille responsive Tailwind: `grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4`.
  - Nouveau sous-composant `SearchResultCard` pour chaque source:
    - Image 16:9 en tête si disponible (og:image prioritaire; fallback twitter:image via endpoint).
    - Hostname + favicon (`LinkFavicon`, `getHostname`, `getHost`).
    - Titre (2 lignes max) et extrait/snippet (2 lignes max).
    - Clic sur la carte/ image: ouvre la source dans un nouvel onglet (`target="_blank" rel="noopener noreferrer"`).
    - Enveloppé par `LinkPreviewPopover` pour le hover preview.
    - `<img loading="lazy">` + `onError` masque l’image si elle échoue.
    - Pas de `next/image` (aucun ajout dans `next.config.mjs`).
- API: `GET /api/og?url=` (Next.js App Router)
  - SSRF guard: protocoles http(s) uniquement; blocage localhost/127.0.0.1/0.0.0.0, IPv4 privés (10/8, 172.16–31/12, 192.168/16, 169.254/16), loopback.
  - Timeout fetch 10s (AbortController), redirections suivies, User-Agent normalisé.
  - Extraction des <meta> dans l’ordre: `og:image`, `og:image:url`, `og:image:secure_url`, puis `twitter:image`/`twitter:image:src`.
  - Normalisation en URL absolue via `new URL(raw, base)`.
  - Réponses: `{ image: string | null }` (200); en échec: 204 `{ image: null }`.
  - Cache: `Cache-Control: s-maxage=86400, stale-while-revalidate=86400`.
- Types partagés
  - `Source` étendu avec `image?: string` (backward-compatible).

## Fichiers modifiés
- `apps/web/app/api/og/route.ts` (nouveau): endpoint d’extraction OG image.
- `packages/common/components/search-results.tsx`: refactor en grille + `SearchResultCard` + fetch OG côté client lorsque `source.image` est absent.
- `packages/shared/types.ts`: ajout `image?: string` sur `Source`.

## Critères d’acceptation (couverts)
- [x] `GET /api/og` renvoie `{ image: string | null }` avec cache-control et protections SSRF basiques.
- [x] `SearchResultsList` rend une grille responsive de cartes avec images OG lorsque dispo; sinon carte texte.
- [x] Clic ouvre la source dans un nouvel onglet; aucun tracking ajouté.
- [x] Aucun changement requis dans `next.config.mjs` (utilisation de `<img>` natif).

## Tests manuels suggérés
- Avec image OG:
  - https://vercel.com
  - https://github.com
- Sans image OG explicite:
  - https://example.com
- Cibles privées (doivent échouer/être bloquées par l’API):
  - http://127.0.0.1:3000
  - http://192.168.1.10

Vérifier:
- Survol: le popover d’aperçu s’affiche.
- Clic carte/ image: ouvret un nouvel onglet sans tracking.
- En cas d’échec d’image: la carte reste propre (texte uniquement).

## Impact
- UI plus visuelle pour l’étape "Reading" en Pro et Deep.
- Aucun changement de logique de recherche (Gemini 2.5 conservé).
- Types partagés backward-compatible. Aucune régression attendue.

## Optimisation ultérieure (optionnelle)
- Enrichir `Source.image` côté serveur (pro-search/web-search) via batch d’appels /api/og pour éviter le N+1 côté client.


₍ᐢ•(ܫ)•ᐢ₎ Generated by [Capy](https://capy.ai) ([view task](https://capy.ai/project/33142fda-3c1e-48a6-bba0-12440191fcc2/task/34afe627-93ca-4406-b827-28a1a4c87c25))