## Verrouillage après 3 échecs + Rate limiting + Journalisation

Cette PR implémente un verrouillage de compte après 3 tentatives de connexion échouées, un rate limiting IP (5 req/min) sur l’endpoint login, et une journalisation exhaustive des événements d’authentification.

Principales modifications
- Prisma
  - User: `failedLoginAttempts`, `isLocked`, `lockedAt`, `lockReason`.
  - ActivityAction: ajout de `login_attempt`, `login_failed`, `lockout`, `unlock`.
  - Indexes: `ActivityLog.ip`, `ActivityLog.action` (en plus de `createdAt`).
  - Migration ajoutée: `20250924011000_lockout_and_rate_limit`.
- API `/api/auth/login` (POST)
  - Enregistre `login_attempt` avant traitement.
  - Rate limiting IP: 5 req/min sur `login_attempt` (retourne 429 avec message FR générique).
  - Refus si `isSuspended` (403, message FR existant).
  - Refus si `isLocked` (403, code `LOCKED`, message explicite FR demandé).
  - Échec mot de passe: incrément de `failedLoginAttempts` en transaction, journalise `login_failed`, déclenche verrouillage à 3 avec `lockReason='lockout_3_attempts'` et journalise `lockout`.
  - Succès: réinitialise `failedLoginAttempts` à 0, crée la session, journalise `login`.
- API admin `/api/admin/users/[id]/unlock` (POST)
  - Protégée par `requireAdmin()`.
  - Réinitialise `failedLoginAttempts`, `isLocked`, `lockedAt`, `lockReason`.
  - Journalise `unlock` (avec `previousLockReason` dans `details`).
- UI Admin
  - Liste utilisateurs: affiche le statut `Verrouillé` quand `isLocked=true`.
  - Actions de ligne: bouton "Réactiver" (unlock) visible quand verrouillé, avec toast FR.
- i18n (FR)
  - `auth.locked.message`
  - `auth.rateLimited.message`

Pourquoi
- Réduire le risque de brute force, protéger les comptes, et fournir des traces d’audit complètes.
- Messages d’erreur explicites côté utilisateur et outillage d’admin pour réactiver rapidement.

Notes de déploiement
- Exécuter les migrations Prisma dans l’environnement (ex.: `prisma migrate deploy`).
- Aucun changement de contrat côté Front hors message d’erreur JSON (ajout éventuel de `errorCode: "LOCKED"`).

Critères d’acceptation couverts
- Verrouillage après 3 échecs, message FR explicite, journalisation `login_attempt`/`login_failed`/`lockout`/`login`/`unlock`.
- Déverrouillage par un administrateur depuis l’UI.
- Rate limiting IP 5 req/min sur login → 429 avec message générique FR.


₍ᐢ•(ܫ)•ᐢ₎ Generated by [Capy](https://capy.ai) ([view task](https://capy.ai/project/572a16e3-84af-11f0-a94e-3eef481a796b/task/7b281c14-0137-4030-a3a5-404f4b8e3ecf))