## Objet
Correctif du mode “Création d’article” pour la saisie pas‑à‑pas (4 champs) et la stabilité du bouton XLSX.

## Problème
Le parcours posait seulement 2 questions (libellé, EAN) en boucle, au lieu d’avancer jusqu’aux 4 champs requis.

## Correctifs
- Saisie pas‑à‑pas robuste (4 étapes):
  - Persistance de l’état entre tours via `CREATION-ARTICLE:STATE={...}` dans le message assistant.
  - Détection du champ attendu via `CREATION-ARTICLE:EXPECT=...` et affectation automatique si la réponse utilisateur est du texte libre.
  - Typage strict des clés requises (`FieldKey`) et map `friendly` typée pour éviter les erreurs d’indexation TypeScript.
  - Suppression des redéclarations/branches redondantes des 4 constantes.
- UI d’export:
  - Un seul bouton XLSX (proche du bouton “Supprimer”) pour le mode “Création d’article”.
  - Masquage de la barre d’export globale pour ce mode.
- Multi‑lignes CSV:
  - Rappel: supporte jusqu’à 300 lignes; classement et génération multi‑lignes inchangés.

## Impact
- Le mode pose bien 4 questions (libellé → EAN → fournisseur → article) puis génère le tableau et affiche le bouton XLSX unique.
- Pas d’impact sur les autres modes ni sur les métriques: `/api/completion` continue d’insérer `MessageLog.mode = 'creation-d-article'`.

## Tests manuels
- Réponses séquentielles en texte libre (sans clés) → la valeur se positionne correctement.
- Entrée CSV multi‑lignes (5 à 10 lignes) → génération d’un seul tableau avec N lignes, export XLSX complet.

## Notes
- Possibilité d’ajouter des validations (EAN‑13/GTIN‑14, longueurs) dans un PR suivant.


₍ᐢ•(ܫ)•ᐢ₎ Generated by [Capy](https://capy.ai) ([view task](https://capy.ai/project/54021583-d007-436a-b7a0-ebc53efe6c8e/task/cffbc71a-6447-493f-916d-81fe1f50313c))