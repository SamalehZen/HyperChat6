const RAW_LABELS = `1. | Numéro d'article (9) | Libellé article (35) | Mot directeur (10) | Libellé article externe (35) | Libellé réduit pour caisses (20) | Type de produit (2) | Catégorie de produit (2) | Code statut article (2) | Code barre (13) | Libellé de l'étiquette (35) | Article hors tarif (1) | Code pays made in (3) | Nomenclature douanière (12) | Nomenclature douanière suite (1) | Code marketing produit (2) | Code présentation (2) | Variété fruits & légumes (25) | Origine fruits & légumes (3) | Calibre description (5) | Calibre dimension 1 (3) | Calibre dimension 2 (3) | Catégorie fruits & légumes (2) | Type alcool (2) | Sous-type alcool (3) | Article garanti 0/1 (1) | Durée de la garantie en mois (2) | Code secteur (2) | Code rayon (3) | Code famille (3) | Code sous- famille (3) | Code ligne de produit (3) | Code sous- ligne de produit (3) | Code métier (3) | Code marque (5) | Code I.F.L.S. (7) | Statistiques (12) | Numéro d'assortiment (3) | Unité consommateur (2) | Conditionnement de vente (5) | Poids brut de l UC (7,3) | Poids net de l U.C. (7,3) | Volume en litres (7,3) | Type prix sur étiquette 1=un.,2=kg,3=lit.,4=mè (1) | Degré si alcool (5,2) | Unité de tarification (2) | Unité tarification = VL 0=Non/1=Oui (1) | Numéro de fournisseur (6) | Réf.article chez fournisseur (30) | Libellé article fournisseur (35) | N° ordre article chez le Frs (9) | Département d'activité (2) | Code statut article chez fournisseur (2) | Numéro d'article consigne (9) | Hauteur de l UC (4,3) | Largeur de l UC (4,3) | Longueur de l UC (4,3) | Minimum de vente (5) | Sous Unité consommateur (5) | Seuil arrondi logistique (%) | N°de Variante logistique Interne. (2) | Libellé de la V.L. (15) | Type de VL 'CA' (2) | N°de VL inférieure (2) | Nbre UC par SPCB (3) | Nbre UC par PCB (4) | Nbre de couches (3) | Nbre UC par UE (5) | Poids brut de l'UE (7,3) | Poids Net de L'UE (7,3) | Hauteur de l'UE (4,3) | Largeur de l UE (4,3) | Longueur de l'UE (4,3) | Numéro d'article consigne (9) | Code statut article (2) | N°de Variante logistique Interne. (2) | Libellé de la V.L. (15) | Type de VL 'PA' (2) | N°de VL inférieure (2) | Nbre UC par SPCB (3) | Nbre UC par PCB (4) | Nbre de couches (3) | Nbre UC par UE (5) | Poids brut de l'UE (7,3) | Poids Net de L'UE (7,3) | Hauteur de l'UE (4,3) | Largeur de l UE (4,3) | Longueur de l'UE (4,3) | Numéro d'article consigne (9) | Code statut article (2) | Article géré en centrale? (0=Non, 1=Oui) (1) | Article suivi en stock (0=Non, 1=Oui) (1) | Durée de stockage maxi (3) | Un. durée stock. maxi J/S/M (1) | Délai de péremption en jours (3) | Température mini (5,2) | Température maxi (5,2) | Entrepot type gestion (3) | Date application 1 (10) | Réassortiment 1 (1) | Type de réappro 1 (2) | Entrepôt 1 (3) | N°de Variante logistique Interne. (2) | Unité stockage = un. cde 0/1 (1) | Qté minimum de commande (9) | Qté maximum de commande (9) | Incrément de commande en VL (9) | Type de réapprovisionnement (2) | Origine approvis. (C ou D) (1) | N° entrepôt (3) | N°de Variante logistque Interne 1 (2) | Qté minimum de commande 1 (9) | Qté maximum de commande 1 (9) | Incrément de commande en VL 1 (9) | Type d'étiquette (2) | Nbre d'étiquettes à éditer (2) | Libellé de l'étiquette (35) | Libellé réduit pour caisses (20) | Code langue (3) | Position clavier balance (6) | Tare (6) | Groupe de balances (3) | Type d etiquette balance (2) | Attribut 1 (3) | Composant 1 (13) | Nombre article de composition 1 (5) | Composant 2 (13) | Nombre article de composition 2 (5) | Composant 3 (13) | Nombre article de composition 3 (5) | Composant 4 (13) | Nombre article de composition 4 (5) | Composant 5 (13) | Nombre article de composition 5 (5) | Génère code barre (0=Non, 1=Oui) (1) | Libell? Etendu 1ere Ligne (70) | Libell? Etendu 2eme Ligne (70) | Libell? Etendu 3eme Ligne (70) | Libell? Etendu 4eme Ligne (70) | Libell? Etendu 5eme Ligne (70) | Num?ro Article Externe (20) | Num?ro Article Origine (9) | Article D?rivable (1) | Gamme 1 (3) | Nombre de Portions 1 (5,2) | Gamme 2 (3) | Nombre de Portions 2 (5,2) | Gamme 3 (3) | Nombre de Portions 3 (5,2) | Gamme 4 (3) | Nombre de Portions 4 (5,2) | Gamme 5 (3) | Nombre de Portions 5 (5,2) | Code type activité (4) | Statut | Message |`;

const RAW_CODES = `| NARTAR | LARTAR | MDIRAR | LAREAR | LREDAR | TYPRAR | CAPRAR | CSTAAR | CEANAR | LETIAR | TREFAR | CPAYEF | NMCDNM | NMC1NM | CMKPAR | CPREAR | VRFLAR | ORFLAR | CALDAR | CAL1AR | CAL2AR | CTFLAR | TYALAR | STALAR | CGARAR | DRGAAR | CSECAR | CRAYAR | CFAMAR | CSFAAR | CLPRAR | CSLPAR | CMETAR | CMARAR | CIFLAR | STATAR | NAS1AS | UCOSVA | CVENVA | PBUEVA | PNETVA | CENTVA | TYPXVA | DEGRAR | UTARUT | UTVLUT | NFOUEF | REFAEF | LARFEF | NORAEF | DACTEF | STAFEF | NARCVA | HAUEVA | LAUEVA | LOUEVA | MVENVA | SSUCVA | SEALAR | NVLOVC | LVLOVC | TYVLVC | NVLIVC | NBSPVC | NBPCVC | NCOUVC | NBUEVC | PBUEVC | PNETVC | HAUEVC | LAUEVC | LOUEVC | NARCVC | CSTAVC | NVLOVP | LVLOVP | TYVLVP | NVLIVP | NBSPVP | NBPCVP | NCOUVP | NBUEVP | PBUEVP | PNETVP | HAUEVP | LAUEVP | LOUEVP | NARCVP | CSTAVP | AGCEAR | ARSKAR | DSTXAR | UDSXAR | DLPEAR | TMINAR | TMAXAR | NENTK1 | DAPLK1 | REASK1 | TYREK1 | NEN1KA | NVLOEF | USTCEF | QCDNEF | QCDXEF | INCREF | TYREEF | ORAPEF | NENTV1 | NVLOV1 | QCDNV1 | QCDXV1 | INCRV1 | TYETAR | NBETAR | LETIAL | LREDAL | CLANAL | POCLVQ | PTARVQ | GRBAVQ | TYBAVQ | CAT1TI | CBA1CO | NBA1CO | CBA2CO | NBA2CO | CBA3CO | NBA3CO | CBA4CO | NBA4CO | CBA5CO | NBA5CO | GENECB | LIB1LE | LIB2LE | LIB3LE | LIB4LE | LIB5LE | NARXAX | NAROAX | ARDRAX | GAM1AG | NBP1AG | GAM2AG | NBP2AG | GAM3AG | NBP3AG | GAM4AG | NBP4AG | GAM5AG | NBP5AG | CTYAFH | STATUT | MESS |`;

const RAW_REF = `| 136246 | CAHIER DE POESIE 170X220 48P INCOLO | CAHIER DE | CAHIER DE POESIE 170X220 48P INCOLO | CAHIER DE POESIE 170 | 01 | | AC | 3020120014739 | CAHIER DE POESIE 170X220 48P INCOLO | P | | 0000 | | | | | | | | | | | | 0 | 0 | 07 | 074 | 742 | 206 | | | | | 0 | | 201 | 01 | 0 | 0.100 | 0.100 | 0.000 | 1 | 0.00 | 01 | 0 | 273 | | CAHIER DE POESIE 170X220 48P INCOLO | | 01 | AC | 0 | 0.000 | 0.000 | 0.000 | 0 | 1 | 0 | 1 | CARTON DE 1 | CA | 0 | 0 | 1 | 0 | 1 | 0.100 | 0.100 | 0.100 | 0.100 | 0.100 | 0 | AC | 0 | | | 0 | 0 | 0 | 0 | 0 | 0.000 | 0.000 | 0.000 | 0.000 | 0.000 | 0 | | 1 | 1 | 0 | | 7 | 0.00 | 0.00 | | 0 | | 1 | 0 | 1 | 9999 | 1 | 1 | C | | 0 | 0 | 0 | 0 | 01 | 1 | | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | | | | | | | 0 | 0 | | 0.00 | | 0.00 | | 0.00 | | 0.00 | | 0.00 | | | |`;

const parseRow = (row: string) => {
  const pipeIndex = row.indexOf('|');
  const content = pipeIndex >= 0 ? row.slice(pipeIndex) : row;
  let tokens = content.split('|').map(s => s.trim());
  if (tokens.length && tokens[0] === '') tokens = tokens.slice(1);
  if (tokens.length && tokens[tokens.length - 1] === '') tokens = tokens.slice(0, -1);
  return tokens;
};

export const HEADERS_LONG: string[] = parseRow(RAW_LABELS);
export const HEADERS_CODES: string[] = parseRow(RAW_CODES);
export const REF_ROW: (string | number)[] = parseRow(RAW_REF);

export const MAX_LENGTHS: Record<string, number> = {
  B: 35,
  C: 10,
  D: 35,
  E: 20,
  J: 35,
  AW: 35,
  I: 20,
};
